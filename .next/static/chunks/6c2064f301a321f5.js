(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,66575,e=>{"use strict";e.s(["AuthWrapper",()=>i]);var s=e.i(43476),t=e.i(71645),r=e.i(18566),a=e.i(27225);function i(e){let{children:i}=e,[l,n]=(0,t.useState)(!0),{user:d,setUser:c}=(0,a.useAuthStore)(),o=(0,r.useRouter)();return((0,t.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/auth/session");if(e.ok){let s=await e.json();c(s.user)}else c(null)}catch(e){console.error("Auth check failed:",e),c(null)}finally{n(!1)}})()},[c]),l)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"})}):(null==d?void 0:d.isAuthenticated)?(0,s.jsx)(s.Fragment,{children:i}):(o.push("/login"),null)}},30257,e=>{"use strict";e.s(["default",()=>o],30257);var s=e.i(43476),t=e.i(66575),r=e.i(71645),a=e.i(18566),i=e.i(19455),l=e.i(15288),n=e.i(27225),d=e.i(75157);function c(){let{user:e,logout:t}=(0,n.useAuthStore)(),{openTrades:c,closedTrades:o,setTrades:x}=(0,n.useTradesStore)(),[h,m]=(0,r.useState)(!0),u=(0,a.useRouter)();(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/trades/log");if(e.ok){let s=await e.json();x(s.data)}}catch(e){console.error("Failed to fetch trades:",e)}finally{m(!1)}})()},[x]);let j=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),t(),u.push("/login")}catch(e){console.error("Logout failed:",e)}},g=(()=>{let e=o.length,s=o.filter(e=>(e.pnl||0)>0).length,t=o.reduce((e,s)=>e+(s.pnl||0),0);return{totalTrades:e,winningTrades:s,totalPnL:t,totalFees:o.reduce((e,s)=>e+(s.fees||0),0),winRate:e>0?s/e:0}})();return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"TFZ Trading Assistant"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Welcome back, ",null==e?void 0:e.username]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(i.Button,{variant:"outline",onClick:()=>u.push("/scanner"),children:"Scanner"}),(0,s.jsx)(i.Button,{variant:"outline",onClick:()=>u.push("/recommend"),children:"Recommender"}),(0,s.jsx)(i.Button,{variant:"outline",onClick:j,children:"Logout"})]})]})})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(l.CardHeader,{className:"pb-2",children:(0,s.jsx)(l.CardTitle,{className:"text-sm font-medium text-gray-600",children:"Open Trades"})}),(0,s.jsx)(l.CardContent,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:c.length})})]}),(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(l.CardHeader,{className:"pb-2",children:(0,s.jsx)(l.CardTitle,{className:"text-sm font-medium text-gray-600",children:"Total P&L"})}),(0,s.jsx)(l.CardContent,{children:(0,s.jsx)("div",{className:"text-2xl font-bold ".concat(g.totalPnL>=0?"text-green-600":"text-red-600"),children:(0,d.formatCurrency)(g.totalPnL)})})]}),(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(l.CardHeader,{className:"pb-2",children:(0,s.jsx)(l.CardTitle,{className:"text-sm font-medium text-gray-600",children:"Win Rate"})}),(0,s.jsx)(l.CardContent,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:(0,d.formatPercent)(g.winRate)})})]}),(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(l.CardHeader,{className:"pb-2",children:(0,s.jsx)(l.CardTitle,{className:"text-sm font-medium text-gray-600",children:"Total Fees"})}),(0,s.jsx)(l.CardContent,{children:(0,s.jsx)("div",{className:"text-2xl font-bold text-red-600",children:(0,d.formatCurrency)(g.totalFees)})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)(l.Card,{children:[(0,s.jsxs)(l.CardHeader,{children:[(0,s.jsx)(l.CardTitle,{children:"Open Trades"}),(0,s.jsx)(l.CardDescription,{children:"Currently active positions"})]}),(0,s.jsx)(l.CardContent,{children:h?(0,s.jsx)("div",{className:"text-center py-4",children:"Loading..."}):0===c.length?(0,s.jsx)("div",{className:"text-center py-4 text-gray-500",children:"No open trades"}):(0,s.jsx)("div",{className:"space-y-3",children:c.slice(0,5).map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.ticker}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:[e.side," spread • ",e.dte," DTE"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"font-medium",children:(0,d.formatCurrency)(e.credit)}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:[e.shortStrike,"/",e.longStrike]})]})]},t))})})]}),(0,s.jsxs)(l.Card,{children:[(0,s.jsxs)(l.CardHeader,{children:[(0,s.jsx)(l.CardTitle,{children:"Recent Closed Trades"}),(0,s.jsx)(l.CardDescription,{children:"Last 5 completed positions"})]}),(0,s.jsx)(l.CardContent,{children:h?(0,s.jsx)("div",{className:"text-center py-4",children:"Loading..."}):0===o.length?(0,s.jsx)("div",{className:"text-center py-4 text-gray-500",children:"No closed trades"}):(0,s.jsx)("div",{className:"space-y-3",children:o.slice(0,5).map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.ticker}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:[e.side," spread • Closed ",new Date(e.closedAt||"").toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"font-medium ".concat((e.pnl||0)>=0?"text-green-600":"text-red-600"),children:(0,d.formatCurrency)(e.pnl||0)}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:(0,d.formatCurrency)(e.credit)})]})]},t))})})]})]})]})]})}function o(){return(0,s.jsx)(t.AuthWrapper,{children:(0,s.jsx)(c,{})})}}]);